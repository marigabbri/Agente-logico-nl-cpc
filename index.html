<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Agente NL ↔ CPC</title>

    <!-- Bootstrap -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap"
          rel="stylesheet">

    <style>
        :root {
            --cor-fundo: #fdf6ff;
            --cor-card: #ffffff;
            --cor-primaria: #f8b4d9;
            --cor-primaria-hover: #f58ac5;
            --cor-secundaria: #a6d8ff;
            --cor-secundaria-hover: #7cc3ff;
            --cor-texto: #4a4a4a;
            --cor-tabs-bg: #ffe9f3;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "Quicksand", sans-serif;
            background: radial-gradient(circle at top, #ffe9f3, #fdf6ff 40%, #e8f7ff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .app-wrapper {
            width: 100%;
            max-width: 900px;
        }

        .box {
            background: var(--cor-card);
            padding: 28px 22px;
            border-radius: 26px;
            box-shadow: 0 18px 45px rgba(0,0,0,0.06);
        }

        .app-title {
            text-align: center;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .nav-tabs {
            background: var(--cor-tabs-bg);
            border-radius: 999px;
            padding: 4px;
            border: none;
        }

        .nav-tabs .nav-link {
            border-radius: 999px;
            font-weight: 600;
        }

        .nav-tabs .nav-link.active {
            background: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        textarea, input {
            border-radius: 14px !important;
            border: 1px solid #e6d8ff !important;
        }

        .resultado-box {
            background: #fff7fe;
            padding: 12px;
            margin-top: 10px;
            border-radius: 14px;
            border: 1px solid #f0c0ea;
            white-space: pre-wrap;
            max-height: 230px;
            overflow-y: auto;
        }
    </style>
</head>

<body>

<div class="app-wrapper">
<div class="box">

    <h2 class="app-title">Tradutor Lógico NL ↔ CPC</h2>
    <p class="text-center text-muted mb-3">
        Converto frases em português para fórmulas lógicas e vice-versa.
    </p>

    <!-- Abas -->
    <ul class="nav nav-tabs mb-3" id="tabs">
        <li class="nav-item">
            <button class="nav-link active" id="tab-nl" onclick="showTab('nl')">
                Linguagem Natural → CPC
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" id="tab-cpc" onclick="showTab('cpc')">
                CPC → Linguagem Natural
            </button>
        </li>
    </ul>

    <!-- NL → CPC -->
    <div id="content-nl">
        <label for="nl-input" class="fw-semibold">Frase em português:</label>
        <textarea id="nl-input" class="form-control" rows="3"
                  placeholder="Ex.: Kiki come de tudo, mas Kiki não é uma gata."></textarea>

        <div class="mt-3 text-end">
            <button class="btn btn-primary" onclick="sendNL()">Traduzir</button>
        </div>

        <div id="nl-result" class="resultado-box" style="display:none;"></div>
    </div>

    <!-- CPC → NL -->
    <div id="content-cpc" style="display:none;">
        <label for="cpc-input" class="fw-semibold">Fórmula:</label>
        <input id="cpc-input" class="form-control" placeholder="Ex.: p^¬q">

        <label for="cpc-map" class="fw-semibold mt-3">Mapeamento (JSON):</label>
        <textarea id="cpc-map" class="form-control" rows="3"
                  placeholder='{"p":"Serena é uma gata","q":"Serena come de tudo"}'></textarea>

        <div class="mt-3 text-end">
            <button class="btn btn-info text-white" onclick="sendCPC()">Traduzir</button>
        </div>

        <div id="cpc-result" class="resultado-box" style="display:none;"></div>
    </div>

</div>
</div>

<script>
    const API_BASE = "https://trabalho-m-rcio-ia-oauo.onrender.com";

    function showTab(tab) {
        document.getElementById("content-nl").style.display = tab === "nl" ? "block" : "none";
        document.getElementById("content-cpc").style.display = tab === "cpc" ? "block" : "none";

        document.getElementById("tab-nl").classList.toggle("active", tab === "nl");
        document.getElementById("tab-cpc").classList.toggle("active", tab === "cpc");
    }

    // NL → CPC
    function sendNL() {
        const frase = document.getElementById("nl-input").value;
        const result = document.getElementById("nl-result");
        result.style.display = "block";

        fetch(`${API_BASE}/api/nl-to-cpc`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ frase })
        })
        .then(res => res.json())
        .then(data => {
            if (!data.ok)
                result.innerHTML = "Erro: " + data.erro;
            else
                result.innerHTML =
                    "Fórmula: " + data.formula_cpc +
                    "\n\nMapeamento:\n" + JSON.stringify(data.mapeamento, null, 2);
        });
    }

    // CPC → NL
    function sendCPC() {
        const formula = document.getElementById("cpc-input").value;
        const mapa = JSON.parse(document.getElementById("cpc-map").value);
        const result = document.getElementById("cpc-result");
        result.style.display = "block";

        fetch(`${API_BASE}/api/cpc-to-nl`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ formula, mapeamento: mapa })
        })
        .then(res => res.json())
        .then(data => {
            if (!data.ok)
                result.innerHTML = "Erro: " + data.erro;
            else
                result.innerHTML = data.frase_nl;
        });
    }
</script>

</body>
</html>
